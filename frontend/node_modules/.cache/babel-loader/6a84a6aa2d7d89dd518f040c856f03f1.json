{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/stepcannuscio/Desktop/Home/Clients/Burman's Health Shop/sims/frontend/src/Orders/OrderPopup.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useRef } from \"react\";\nimport * as router from \"./orderAPI\";\nimport * as helpers from \"../helpers\";\nexport default function OrderPopup(props) {\n  _s();\n\n  const [data, setData] = useState([]);\n  const [originalData, setOriginalData] = useState([]);\n  const [productData, setProductData] = useState([]);\n  const [variantData, setVariantData] = useState([]);\n  const [quantity, setQuantity] = useState(0);\n  const [isLoading, setLoading] = useState(false);\n  const [orderBtnText, setOrderBtnText] = useState(\"Edit Order\");\n  const [orderItemBtnText, setOrderItemBtnText] = useState(\"Edit Order Item\");\n  const [isEditingOrder, setEditingOrder] = useState(false);\n  const [isEditingOrderItem, setEditingOrderItem] = useState(false);\n  const [editColor, setEditColor] = useState(\"#76c32d\");\n  const [idsToUpdate, setIdsToUpdate] = useState([]);\n  const [dataToUpdate, setDataToUpdate] = useState([]);\n  const [itemsToDelete, setItemsToDelete] = useState([]);\n  const [itemsToAdd, setItemsToAdd] = useState([]);\n  const [idsToAdd, setIdsToAdd] = useState([]);\n  const [isProductSelectHidden, setProductSelectHidden] = useState(true);\n  const [isVariantSelectHidden, setVariantSelectHidden] = useState(true);\n  const [isQuantityHidden, setQuantityHidden] = useState(true);\n  const [isAddBtnHidden, setAddBtnHidden] = useState(true);\n  const orderSubtotal = useRef();\n  const orderDiscount = useRef();\n  const tracking = useRef();\n  const status = useRef();\n  const product = useRef();\n  const variant = useRef();\n  const inputStyle = {\n    margin: \"20px auto\",\n    padding: \"10px 20px\",\n    fontSize: \"16px\",\n    border: \"none\",\n    borderBottom: \"1px solid #76c32d\"\n  };\n\n  function getData() {\n    setLoading(true);\n    router.loadOrder(props.values.id).then(data => {\n      if (data) {\n        setData(data);\n        const newData = data.map(a => ({ ...a\n        })); // make copy to compare dataToUpdate with to look for changes\n\n        setOriginalData(newData);\n        setLoading(false);\n      }\n    });\n  }\n\n  useEffect(() => {\n    getData(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loader\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 16\n    }, this);\n  }\n\n  function editBtnClicked(e) {\n    if (e.target.id === \"order-btn\") {\n      if (!isEditingOrder) {\n        setOrderBtnText(\"Save Order\");\n        setEditingOrder(true);\n      } else {\n        saveOrder();\n      }\n    } else if (e.target.id === \"order-item-btn\") {\n      if (!isEditingOrderItem) {\n        setOrderItemBtnText(\"Save Order Item\");\n        setEditingOrderItem(true);\n      } else {\n        saveOrderItem();\n      }\n    }\n\n    setEditColor(editColor === \"#26B1FF\" ? \"#76c32d\" : \"#26B1FF\");\n  }\n\n  function saveOrder() {\n    const orderData = {\n      subtotal: orderSubtotal.current.value ? orderSubtotal.current.value : data[0].order_subtotal,\n      discount: orderDiscount.current.value ? orderDiscount.current.value : data[0].order_discount,\n      status: status.current.value ? status.current.value : data[0].status,\n      tracking: tracking.current.value ? tracking.current.value : data[0].tracking\n    };\n    const discountsToUpdate = [];\n    data.forEach(item => {\n      if (item.discount === \"0\" || item.discount === 0 || item.discount === \"\") {\n        discountsToUpdate.push(item);\n      }\n    });\n    router.updateOrder(orderData, props.values.id, data, discountsToUpdate).then(data => {\n      if (data === \"Success\") {\n        setEditingOrder(false);\n        setOrderBtnText(\"Edit Order\");\n        getData();\n      } else {\n        alert(\"Failed to save order. Please try again.\");\n        setOrderBtnText(\"Edit Order\");\n      }\n    });\n  }\n\n  function saveOrderItem() {\n    const updatedData = [];\n    dataToUpdate.forEach(newItem => {\n      originalData.forEach(ogItem => {\n        if (ogItem.order_item_id === newItem.order_item_id) {\n          // Same item\n          if (newItem.quantity !== ogItem.quantity && newItem.quantity || newItem.cost !== ogItem.cost && newItem.cost || newItem.discount !== ogItem.discount && newItem.discount) {\n            // data has changed, so should save this item\n            newItem.quantity = newItem.quantity ? newItem.quantity : ogItem.quantity;\n            newItem.cost = newItem.cost ? newItem.cost : ogItem.cost;\n            newItem.discount = newItem.discount ? newItem.discount : ogItem.discount;\n            updatedData.push(newItem);\n          }\n        }\n      });\n    });\n    router.updateOrderItem(updatedData, props.values.id, itemsToDelete, itemsToAdd).then(data => {\n      if (data === \"Success\") {\n        setEditingOrderItem(false);\n        setOrderItemBtnText(\"Edit Order Items\");\n        getData();\n        setDataToUpdate([]);\n        setIdsToUpdate([]);\n        setItemsToAdd([]);\n        setItemsToDelete([]);\n      } else {\n        alert(\"Failed to save order items. Please try again.\");\n        setOrderItemBtnText(\"Edit Order Items\");\n      }\n    });\n  }\n\n  function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  }\n\n  function editInput(data, value, type) {\n    data[type] = value; // update the value to be what was entered in the inputs\n\n    if (value !== \"0\" && value !== 0 && value !== \"\") {\n      if (idsToUpdate.includes(data.order_item_id)) {\n        // Item is in array so let's update it\n        dataToUpdate.forEach((item, index) => {\n          if (item.order_item_id === data.order_item_id) {\n            var array = [...dataToUpdate]; // make a separate copy of the array\n\n            if (index !== -1) {\n              array.splice(index, 1);\n              setDataToUpdate(array);\n            }\n\n            setDataToUpdate(oldArray => [...oldArray, data]);\n          }\n        });\n      } else if (idsToAdd.includes(data.variant_id)) {\n        itemsToAdd.forEach((item, index) => {\n          if (item.variant_id === data.variant_id) {\n            var array = [...itemsToAdd]; // make a separate copy of the array\n\n            if (index !== -1) {\n              array.splice(index, 1);\n              setItemsToAdd(array);\n            }\n\n            setItemsToAdd(oldArray => [...oldArray, data]);\n          }\n        });\n      } else {\n        setIdsToUpdate(oldArray => [...oldArray, data.order_item_id]);\n        setDataToUpdate(oldArray => [...oldArray, data]);\n      }\n    }\n  }\n\n  function remove(itemToRemove) {\n    data.forEach((item, index) => {\n      if (item.order_item_id === itemToRemove.order_item_id) {\n        var array = [...data]; // make a separate copy of the array\n\n        setItemsToDelete(oldArray => [...oldArray, item.order_item_id]);\n\n        if (index !== -1) {\n          array.splice(index, 1);\n          setData(array);\n        }\n      }\n    });\n  }\n\n  function addItem() {\n    const variantIndex = variant.current.selectedIndex;\n    const productIndex = product.current.selectedIndex;\n    const newData = {\n      product: product.current[productIndex].text,\n      variant: variant.current[variantIndex].text,\n      variant_id: variant.current.value.split('-')[0],\n      cost: variant.current.value.split('-')[1],\n      quantity: quantity,\n      discount: 0\n    };\n    setData(oldArray => [...oldArray, newData]);\n    setItemsToAdd(oldArray => [...oldArray, newData]);\n    setIdsToAdd(oldArray => [...oldArray, newData.variant_id]);\n    setProductSelectHidden(true);\n    setVariantSelectHidden(true);\n    setQuantityHidden(true);\n    setAddBtnHidden(true);\n    setProductData([]);\n    setVariantData([]);\n    setQuantity(0);\n  }\n\n  function startAddFlow() {\n    router.loadProducts(data[0].vendor_id).then(data => {\n      if (data) {\n        setProductData(data.products);\n        setProductSelectHidden(false);\n      } else {\n        alert(\"Failed to load products. Please try again.\");\n      }\n    });\n  }\n\n  function loadVariants(productId) {\n    router.loadVariants(productId).then(data => {\n      if (data) {\n        setVariantData(data);\n        setVariantSelectHidden(false);\n      } else {\n        alert(\"Failed to load variants. Please try again.\");\n      }\n    });\n  }\n\n  const EditItem = props => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"inline-block\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          display: \"inline-block\",\n          margin: \"10px\",\n          fontSize: \"1.1rem\"\n        },\n        children: `${props.title}: `\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"table-cell\",\n        type: \"text\",\n        id: props.id,\n        ref: props.refName,\n        placeholder: props.placeholder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 13\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"top-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"close\",\n        onClick: () => props.toggle(),\n        children: \"\\xD7    \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          fontSize: \"2rem\"\n        },\n        children: [\"Order #\", data.length > 0 ? data[0].order_id : \"Error loading data\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontSize: \"1.4rem\"\n        },\n        children: [\"Vendor: \", data.length > 0 ? data[0].name : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: isEditingOrder ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(EditItem, {\n            title: \"Subtotal\",\n            id: \"order-subtotal\",\n            placeholder: data.length > 0 ? helpers.formatter.format(data[0].order_subtotal) : \"\",\n            refName: orderSubtotal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(EditItem, {\n            title: \"Discount\",\n            id: \"order-discount\",\n            placeholder: data.length > 0 ? helpers.formatter.format(data[0].order_discount) : \"\",\n            refName: orderDiscount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              display: \"inline-block\",\n              margin: \"10px\",\n              fontSize: \"1.1rem\"\n            },\n            children: [\"Total: \", data.length > 0 ? helpers.formatter.format(data[0].order_total) : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 17\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              display: \"inline-block\",\n              margin: \"10px\",\n              fontSize: \"1.1rem\"\n            },\n            children: [\"Subtotal: \", data.length > 0 ? helpers.formatter.format(data[0].order_subtotal) : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              display: \"inline-block\",\n              margin: \"10px\",\n              fontSize: \"1.1rem\"\n            },\n            children: [\"Discount: \", data.length > 0 ? helpers.formatter.format(data[0].order_discount) : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              display: \"inline-block\",\n              margin: \"10px\",\n              fontSize: \"1.1rem\"\n            },\n            children: [\"Total: \", data.length > 0 ? helpers.formatter.format(data[0].order_total) : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 17\n      }, this), isEditingOrder ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"select\", {\n          style: inputStyle,\n          defaultValue: data.length > 0 ? data[0].status : \"submitted\",\n          ref: status,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"submitted\",\n            children: \"Submitted\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"fulfilled\",\n            children: \"Fulfilled\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"completed\",\n            children: \"Completed\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(EditItem, {\n          title: \"Tracking\",\n          id: \"tracking\",\n          placeholder: data.length > 0 && data[0].tracking ? data[0].tracking : \"Enter tracking...\",\n          refName: tracking\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 17\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: \"1.1rem\",\n            color: data.length > 0 && data[0].status === \"submitted\" ? \"red\" : data.length > 0 && data[0].status === \"fulfilled\" ? \"orange\" : \"green\"\n          },\n          children: [\"Status: \", data.length > 0 ? capitalizeFirstLetter(data[0].status) : \"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            margin: \"10px\",\n            fontSize: \"1.1rem\"\n          },\n          children: [\"Tracking: \", data.length > 0 && data[0].tracking ? data[0].tracking : \"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            display: \"inline-block\",\n            margin: \"10px\",\n            fontSize: \"1.1rem\"\n          },\n          children: [\"Submitted: \", data.length > 0 ? data[0].submitted_date : \"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            display: \"inline-block\",\n            margin: \"10px\",\n            fontSize: \"1.1rem\"\n          },\n          children: [\"Fulfilled: \", data.length > 0 ? data[0].fulfilled_date : \"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            display: \"inline-block\",\n            margin: \"10px\",\n            fontSize: \"1.1rem\"\n          },\n          children: [\"Completed: \", data.length > 0 ? data[0].completed_date : \"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        hidden: isEditingOrderItem || data.length > 0 && data[0].status === \"completed\",\n        onClick: editBtnClicked,\n        className: \"edit-btn\",\n        id: \"order-btn\",\n        style: {\n          backgroundColor: editColor\n        },\n        children: orderBtnText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 18\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        hidden: isEditingOrder || data.length > 0 && data[0].status === \"completed\",\n        onClick: editBtnClicked,\n        className: \"edit-btn\",\n        id: \"order-item-btn\",\n        style: {\n          backgroundColor: editColor\n        },\n        children: orderItemBtnText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      style: {\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Product\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Variant\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Cost/unit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Quantity\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Subtotal\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Discount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"table-header\",\n            children: \"Remove\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: data.map((item, index) => {\n          return isEditingOrderItem ? /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: item.product\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: item.variant\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"table-cell\",\n                type: \"text\",\n                onChange: e => editInput(item, e.target.value, \"cost\"),\n                placeholder: helpers.formatter.format(item.cost)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"table-cell\",\n                type: \"text\",\n                onChange: e => editInput(item, e.target.value, \"quantity\"),\n                placeholder: item.quantity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: helpers.formatter.format(item.cost * item.quantity)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"table-cell\",\n                type: \"text\",\n                onChange: e => editInput(item, e.target.value, \"discount\"),\n                placeholder: helpers.formatter.format(item.discount)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 347,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: helpers.formatter.format(item.cost * item.quantity - item.discount)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"close\",\n                style: {\n                  color: \"red\"\n                },\n                onClick: () => remove(item),\n                children: \"\\xD7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 33\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: item.product\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: item.variant\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: helpers.formatter.format(item.cost)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: item.quantity\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: helpers.formatter.format(item.cost * item.quantity)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: helpers.formatter.format(item.discount)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"table-cell\",\n              children: helpers.formatter.format(item.cost * item.quantity - item.discount)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 33\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 13\n    }, this), isEditingOrderItem ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startAddFlow,\n        children: \"+\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        ref: product,\n        hidden: isProductSelectHidden,\n        defaultValue: \"default\",\n        onChange: e => {\n          loadVariants(e.target.value);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"default\",\n          children: \"Choose Product:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 13\n        }, this), productData.map(product => {\n          return /*#__PURE__*/_jsxDEV(\"option\", {\n            value: product.id,\n            children: product.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 25\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        ref: variant,\n        hidden: isVariantSelectHidden,\n        defaultValue: \"default\",\n        onChange: e => {\n          setQuantityHidden(false);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"default\",\n          children: \"Choose Variant:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 13\n        }, this), variantData.map(variant => {\n          return /*#__PURE__*/_jsxDEV(\"option\", {\n            value: `${variant.id}-${variant.cost}`,\n            children: variant.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 25\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        hidden: isQuantityHidden,\n        defaultValue: \"0\",\n        onChange: e => {\n          setQuantity(e.target.value);\n          setAddBtnHidden(false);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        hidden: isAddBtnHidden,\n        onClick: addItem,\n        children: \"Add Item\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 271,\n    columnNumber: 9\n  }, this);\n}\n\n_s(OrderPopup, \"TH36lH4DaPLPEqbPuZnf5MbtIWc=\");\n\n_c = OrderPopup;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderPopup\");","map":{"version":3,"sources":["/Users/stepcannuscio/Desktop/Home/Clients/Burman's Health Shop/sims/frontend/src/Orders/OrderPopup.js"],"names":["useState","useEffect","useRef","router","helpers","OrderPopup","props","data","setData","originalData","setOriginalData","productData","setProductData","variantData","setVariantData","quantity","setQuantity","isLoading","setLoading","orderBtnText","setOrderBtnText","orderItemBtnText","setOrderItemBtnText","isEditingOrder","setEditingOrder","isEditingOrderItem","setEditingOrderItem","editColor","setEditColor","idsToUpdate","setIdsToUpdate","dataToUpdate","setDataToUpdate","itemsToDelete","setItemsToDelete","itemsToAdd","setItemsToAdd","idsToAdd","setIdsToAdd","isProductSelectHidden","setProductSelectHidden","isVariantSelectHidden","setVariantSelectHidden","isQuantityHidden","setQuantityHidden","isAddBtnHidden","setAddBtnHidden","orderSubtotal","orderDiscount","tracking","status","product","variant","inputStyle","margin","padding","fontSize","border","borderBottom","getData","loadOrder","values","id","then","newData","map","a","editBtnClicked","e","target","saveOrder","saveOrderItem","orderData","subtotal","current","value","order_subtotal","discount","order_discount","discountsToUpdate","forEach","item","push","updateOrder","alert","updatedData","newItem","ogItem","order_item_id","cost","updateOrderItem","capitalizeFirstLetter","string","charAt","toUpperCase","slice","editInput","type","includes","index","array","splice","oldArray","variant_id","remove","itemToRemove","addItem","variantIndex","selectedIndex","productIndex","text","split","startAddFlow","loadProducts","vendor_id","products","loadVariants","productId","EditItem","display","title","refName","placeholder","toggle","length","order_id","name","formatter","format","order_total","textAlign","color","submitted_date","fulfilled_date","completed_date","backgroundColor"],"mappings":"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","sourcesContent":["import {useState, useEffect, useRef} from \"react\"\nimport * as router from \"./orderAPI\"\nimport * as helpers from \"../helpers\"\n\nexport default function OrderPopup(props) {\n    \n    const [data, setData] = useState([])\n    const [originalData, setOriginalData] = useState([])\n    const [productData, setProductData] = useState([])\n    const [variantData, setVariantData] = useState([])\n    const [quantity, setQuantity] = useState(0)\n    const [isLoading, setLoading] = useState(false)\n    const [orderBtnText, setOrderBtnText] = useState(\"Edit Order\")\n    const [orderItemBtnText, setOrderItemBtnText] = useState(\"Edit Order Item\")\n    const [isEditingOrder, setEditingOrder] = useState(false)\n    const [isEditingOrderItem, setEditingOrderItem] = useState(false)\n    const [editColor, setEditColor] = useState(\"#76c32d\")\n    const [idsToUpdate, setIdsToUpdate] = useState([])\n    const [dataToUpdate, setDataToUpdate] = useState([])\n    const [itemsToDelete, setItemsToDelete] = useState([])\n    const [itemsToAdd, setItemsToAdd] = useState([])\n    const [idsToAdd, setIdsToAdd] = useState([])\n\n    const [isProductSelectHidden, setProductSelectHidden] = useState(true)\n    const [isVariantSelectHidden, setVariantSelectHidden] = useState(true)\n    const [isQuantityHidden, setQuantityHidden] = useState(true)\n    const [isAddBtnHidden, setAddBtnHidden] = useState(true)\n\n    const orderSubtotal = useRef()\n    const orderDiscount = useRef()\n    const tracking = useRef()\n    const status = useRef()\n    const product = useRef()\n    const variant = useRef()\n\n    const inputStyle = {\n        margin: \"20px auto\",\n        padding: \"10px 20px\",\n        fontSize: \"16px\",\n        border: \"none\",\n        borderBottom: \"1px solid #76c32d\"\n    }\n\n\n\n    function getData() {\n        setLoading(true)\n        router.loadOrder(props.values.id).then(data => {\n            if (data) {\n                setData(data)\n                const newData = data.map(a => ({...a})) // make copy to compare dataToUpdate with to look for changes\n                setOriginalData(newData)\n                setLoading(false)      \n            }\n        })\n    }\n\n    useEffect(() => {\n        getData()\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    if (isLoading) {\n        return <div className=\"loader\"></div>;\n    }\n\n    function editBtnClicked(e) {\n       \n        if (e.target.id === \"order-btn\") {\n            if (!isEditingOrder) {\n                setOrderBtnText(\"Save Order\")\n                setEditingOrder(true)\n            } else {\n                saveOrder()\n            }\n        } else if (e.target.id === \"order-item-btn\") {\n            if (!isEditingOrderItem) {\n                setOrderItemBtnText(\"Save Order Item\")\n                setEditingOrderItem(true)\n            } else {\n                saveOrderItem()\n            }\n        }\n        setEditColor(editColor === \"#26B1FF\" ? \"#76c32d\" : \"#26B1FF\")  \n    }\n\n    function saveOrder() {\n        const orderData = {\n            subtotal: orderSubtotal.current.value ? orderSubtotal.current.value : data[0].order_subtotal,\n            discount: orderDiscount.current.value ? orderDiscount.current.value : data[0].order_discount,\n            status: status.current.value ? status.current.value : data[0].status,\n            tracking: tracking.current.value ? tracking.current.value : data[0].tracking,\n        }\n\n        const discountsToUpdate = []\n\n        data.forEach(item => {\n            if (item.discount === \"0\" || item.discount === 0 || item.discount === \"\") {\n                discountsToUpdate.push(item)\n            }\n        })\n\n        router.updateOrder(orderData, props.values.id, data, discountsToUpdate).then(data => {\n            if (data === \"Success\") {\n                setEditingOrder(false)\n                setOrderBtnText(\"Edit Order\")\n                getData()\n            } else {\n                alert(\"Failed to save order. Please try again.\")\n                setOrderBtnText(\"Edit Order\")\n            }\n        })      \n    }\n\n    function saveOrderItem() {\n\n        const updatedData = []\n\n        dataToUpdate.forEach(newItem => {\n            originalData.forEach(ogItem => {\n                if (ogItem.order_item_id === newItem.order_item_id) {\n                    // Same item\n                    if ((newItem.quantity !== ogItem.quantity && newItem.quantity)|| \n                        (newItem.cost !== ogItem.cost && newItem.cost) || \n                        (newItem.discount !== ogItem.discount && newItem.discount)) {\n                            // data has changed, so should save this item\n                            newItem.quantity = newItem.quantity ? newItem.quantity : ogItem.quantity\n                            newItem.cost = newItem.cost ? newItem.cost : ogItem.cost\n                            newItem.discount = newItem.discount ? newItem.discount : ogItem.discount\n\n                            updatedData.push(newItem)\n                        }\n                }\n            })\n        })\n\n        router.updateOrderItem(updatedData, props.values.id, itemsToDelete, itemsToAdd).then(data => {\n            if (data === \"Success\") {\n                setEditingOrderItem(false)\n                setOrderItemBtnText(\"Edit Order Items\")\n                getData()\n                setDataToUpdate([])\n                setIdsToUpdate([])\n                setItemsToAdd([])\n                setItemsToDelete([])\n            } else {\n                alert(\"Failed to save order items. Please try again.\")\n                setOrderItemBtnText(\"Edit Order Items\")\n            }\n        })\n    }\n        \n    function capitalizeFirstLetter(string) {\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    }\n\n    function editInput(data, value, type) {\n        data[type] = value // update the value to be what was entered in the inputs\n\n        if (value !== \"0\" && value !== 0 && value !== \"\") {\n            \n\n            if (idsToUpdate.includes(data.order_item_id)) {\n                // Item is in array so let's update it\n                dataToUpdate.forEach((item, index) => {\n                    \n                    if (item.order_item_id === data.order_item_id) {\n                        var array = [...dataToUpdate]; // make a separate copy of the array\n                        if (index !== -1) {\n                            array.splice(index, 1);\n                            setDataToUpdate(array);\n                        } \n                            setDataToUpdate(oldArray => [...oldArray, data])   \n                    }  \n                })\n            } else if (idsToAdd.includes(data.variant_id)) {\n                itemsToAdd.forEach((item, index) => {\n                    if (item.variant_id === data.variant_id) {\n                        var array = [...itemsToAdd]; // make a separate copy of the array\n                        if (index !== -1) {\n                            array.splice(index, 1);\n                            setItemsToAdd(array);\n                        } \n                        setItemsToAdd(oldArray => [...oldArray, data])   \n                    }  \n                })\n            } else {\n                setIdsToUpdate(oldArray => [...oldArray, data.order_item_id])\n                setDataToUpdate(oldArray => [...oldArray, data])\n            }\n        }       \n    }\n\n    function remove(itemToRemove) {\n\n        data.forEach((item, index) => {\n            if (item.order_item_id === itemToRemove.order_item_id) {\n                var array = [...data]; // make a separate copy of the array\n                setItemsToDelete(oldArray => [...oldArray, item.order_item_id])   \n                if (index !== -1) {\n                    array.splice(index, 1);\n                    setData(array);\n                }             \n            }\n        })\n    }\n\n    function addItem() {\n\n        const variantIndex = variant.current.selectedIndex\n        const productIndex = product.current.selectedIndex\n\n        const newData = {\n            product: product.current[productIndex].text,\n            variant: variant.current[variantIndex].text,\n            variant_id: variant.current.value.split('-')[0],\n            cost: variant.current.value.split('-')[1],\n            quantity: quantity,\n            discount: 0\n        }\n\n        setData(oldArray => [...oldArray, newData])  \n        setItemsToAdd(oldArray => [...oldArray, newData]) \n        setIdsToAdd(oldArray => [...oldArray, newData.variant_id])\n\n        setProductSelectHidden(true)\n        setVariantSelectHidden(true)\n        setQuantityHidden(true)\n        setAddBtnHidden(true)\n\n        setProductData([])\n        setVariantData([])\n        setQuantity(0)\n\n    }\n\n    function startAddFlow() {\n        router.loadProducts(data[0].vendor_id).then(data => {\n            if (data) {\n                setProductData(data.products)\n                setProductSelectHidden(false)\n            } else {\n                alert(\"Failed to load products. Please try again.\")\n            }\n        })\n        \n    }\n\n    function loadVariants(productId) {\n        router.loadVariants(productId).then(data => {\n            if (data) {\n                setVariantData(data)\n                setVariantSelectHidden(false)\n            } else {\n                alert(\"Failed to load variants. Please try again.\")\n            }\n        })\n    }\n    \n\n    const EditItem = (props) => {\n        return (\n            <div style={{display: \"inline-block\"}}>\n            <p style={{display: \"inline-block\", margin: \"10px\",fontSize: \"1.1rem\"}}>{`${props.title}: `}</p>\n            <input className=\"table-cell\" type=\"text\" id={props.id} ref={props.refName} placeholder={props.placeholder}/>\n        </div>\n        )\n    }\n\n    return (\n        <div>\n            <div className=\"top-content\">\n                <span className=\"close\" onClick={() =>  props.toggle()}>&times;    </span>\n                <h2 style={{fontSize: \"2rem\"}}>Order #{data.length > 0 ? data[0].order_id : \"Error loading data\"}</h2>\n                <p style={{fontSize: \"1.4rem\"}}>Vendor: {data.length > 0 ? data[0].name : \"\"}</p>\n                <div>\n                {isEditingOrder\n                ? \n                <div>\n                    <EditItem title=\"Subtotal\" id=\"order-subtotal\" placeholder={data.length > 0 ? helpers.formatter.format(data[0].order_subtotal) : \"\"} refName={orderSubtotal}/>\n                    <EditItem title=\"Discount\" id=\"order-discount\" placeholder={data.length > 0 ? helpers.formatter.format(data[0].order_discount) : \"\"} refName={orderDiscount}/>\n                    <p style={{display: \"inline-block\", margin: \"10px\", fontSize: \"1.1rem\"}}>Total: {data.length > 0 ? helpers.formatter.format(data[0].order_total) : \"\"}</p>\n                </div>\n                :\n                <div>\n                    <p style={{display: \"inline-block\", margin: \"10px\",fontSize: \"1.1rem\"}}>Subtotal: {data.length > 0 ? helpers.formatter.format(data[0].order_subtotal) : \"\"}</p>\n                    <p style={{display: \"inline-block\", margin: \"10px\", fontSize: \"1.1rem\"}}>Discount: {data.length > 0 ? helpers.formatter.format(data[0].order_discount) : \"\"}</p>\n                    <p style={{display: \"inline-block\", margin: \"10px\", fontSize: \"1.1rem\"}}>Total: {data.length > 0 ? helpers.formatter.format(data[0].order_total) : \"\"}</p>\n                </div>\n                }\n                </div>\n\n                {isEditingOrder \n                ?\n                <div style={{textAlign: \"center\"}}>\n                    <select style={inputStyle} defaultValue={data.length > 0 ? data[0].status : \"submitted\"} ref={status}>\n                        <option value=\"submitted\">Submitted</option>\n                        <option value=\"fulfilled\">Fulfilled</option>\n                        <option value=\"completed\">Completed</option>\n                    </select>\n                    <br />\n                    <EditItem title=\"Tracking\" id=\"tracking\" placeholder={data.length > 0  && data[0].tracking ? data[0].tracking : \"Enter tracking...\"} refName={tracking}/>\n                </div>\n                :\n                <div>\n                    <p style={{fontSize: \"1.1rem\", color: data.length > 0 && data[0].status === \"submitted\" ? \"red\" : data.length > 0 && data[0].status===\"fulfilled\" ? \"orange\" : \"green\"}}>Status: {data.length > 0 ? capitalizeFirstLetter(data[0].status) : \"\"}</p>\n                    <p style={{margin: \"10px\",fontSize: \"1.1rem\"}}>Tracking: {data.length > 0 && data[0].tracking ? data[0].tracking : \"\"}</p>\n                </div>\n                }\n                <div>\n                    <p style={{display: \"inline-block\", margin: \"10px\", fontSize: \"1.1rem\"}}>Submitted: {data.length > 0 ? data[0].submitted_date : \"\"}</p>\n                    <p style={{display: \"inline-block\", margin: \"10px\", fontSize: \"1.1rem\"}}>Fulfilled: {data.length > 0 ? data[0].fulfilled_date : \"\"}</p>\n                    <p style={{display: \"inline-block\", margin: \"10px\", fontSize: \"1.1rem\"}}>Completed: {data.length > 0 ? data[0].completed_date : \"\"}</p>\n                </div>\n                 <button hidden={isEditingOrderItem || (data.length > 0 && data[0].status === \"completed\")} onClick={editBtnClicked} className=\"edit-btn\" id=\"order-btn\"style={{backgroundColor: editColor}}>{orderBtnText}</button>\n                 <button hidden={isEditingOrder || (data.length > 0 && data[0].status === \"completed\")} onClick={editBtnClicked} className=\"edit-btn\" id='order-item-btn' style={{backgroundColor: editColor}}>{orderItemBtnText}</button>\n            </div>\n            <table style={{textAlign: \"center\"}}>\n                <thead >\n                    <tr>\n                        <th className=\"table-header\">Product</th>\n                        <th className=\"table-header\">Variant</th>\n                        <th className=\"table-header\">Cost/unit</th>\n                        <th className=\"table-header\">Quantity</th>\n                        <th className=\"table-header\">Subtotal</th>\n                        <th className=\"table-header\">Discount</th>\n                        <th className=\"table-header\">Total</th>\n                        <th className=\"table-header\">Remove</th>\n                    </tr>\n                </thead>\n                <tbody>\n                {data.map((item, index) => {\n                    return (\n                         isEditingOrderItem\n                            ? \n                            <tr key={index}>\n                                <td className=\"table-cell\">{item.product}</td>\n                                <td className=\"table-cell\">{item.variant}</td>\n                                <td className=\"table-cell\">\n                                    <input className=\"table-cell\" type=\"text\" onChange={(e) => editInput(item, e.target.value, \"cost\")} placeholder={helpers.formatter.format(item.cost)} />\n                                </td>\n                                <td className=\"table-cell\">\n                                    <input className=\"table-cell\" type=\"text\" onChange={(e) => editInput(item, e.target.value, \"quantity\")} placeholder={item.quantity} />\n                                </td>\n                                <td className=\"table-cell\">{helpers.formatter.format(item.cost * item.quantity)}</td>\n                                <td className=\"table-cell\">\n                                    <input className=\"table-cell\" type=\"text\" onChange={(e) => editInput(item, e.target.value, \"discount\")} placeholder={helpers.formatter.format(item.discount)} />\n                                </td>\n                                <td className=\"table-cell\">{helpers.formatter.format((item.cost * item.quantity) - item.discount)}</td>  \n                                <td><span className=\"close\" style={{color: \"red\"}} onClick={() =>  remove(item)}>&times;</span></td>\n                            </tr>\n          \n                            :\n                            <tr key={index}>\n                                <td className=\"table-cell\">{item.product}</td>\n                                <td className=\"table-cell\">{item.variant}</td>\n                                <td className=\"table-cell\">{helpers.formatter.format(item.cost)}</td>\n                                <td className=\"table-cell\">{item.quantity}</td>\n                                <td className=\"table-cell\">{helpers.formatter.format(item.cost * item.quantity)}</td> \n                                <td className=\"table-cell\">{helpers.formatter.format(item.discount)}</td>\n                                <td className=\"table-cell\">{helpers.formatter.format((item.cost * item.quantity) - item.discount)}</td>    \n                            </tr> \n                    )\n                    })\n                }\n                </tbody>\n            </table>\n            {isEditingOrderItem\n            ?\n            <div>\n            <button onClick={startAddFlow}>+</button>\n            <select ref={product} hidden={isProductSelectHidden} defaultValue=\"default\" onChange={(e) => {\n                loadVariants(e.target.value)\n            }}>\n            <option value=\"default\">Choose Product:</option>\n                {productData.map(product => {\n                    return (\n                        <option value={product.id}>{product.title}</option>         \n                    )\n                })}\n            </select>\n            <select ref={variant} hidden={isVariantSelectHidden} defaultValue=\"default\" onChange={(e) => {\n                setQuantityHidden(false)\n            }}>\n            <option value=\"default\">Choose Variant:</option>\n                {variantData.map(variant => {   \n                    return (\n                        <option value={`${variant.id}-${variant.cost}`}>{variant.title}</option>         \n                    )\n                })}\n            </select>\n            <input hidden={isQuantityHidden} defaultValue=\"0\" onChange={(e) => {\n                setQuantity(e.target.value)\n                setAddBtnHidden(false)\n            }}></input>\n            <button hidden={isAddBtnHidden} onClick={addItem}>Add Item</button>\n            </div>\n            :\n            <p></p>\n                }\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}